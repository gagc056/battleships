!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var s=(e,t)=>{e.newGame.style.visibility="hidden",e.placement.style.visibility="hidden",e.playComputer.style.visibility="hidden";const n={phases:{newGame:{start:t.newGame,element:e.newGame},placement:{start:t.placement,element:e.placement},playComputer:{start:t.playComputer,element:e.playComputer}},hideAll:()=>{for(const e in n.phases)n.phases[e].element.style.visibility="hidden"},setPhase:e=>{switch(n.hideAll(),e){case"NEW_GAME":n.phases.newGame.start(n),n.phases.newGame.element.style.visibility="visible";break;case"PLACEMENT":n.phases.placement.start(n),n.phases.placement.element.style.visibility="visible";break;case"PLAY_COMPUTER":n.phases.playComputer.start(n),n.phases.playComputer.element.style.visibility="visible"}},gameboards:[null,null],names:[null,null],colors:[null,null],selectedGameboard:0,nextScreen:null};return n};var o=e=>{const t={length:e,hits:new Array(e).fill(!1),isSunk:()=>{for(let e=0;e<t.hits.length;e+=1)if(!1===t.hits[e])return!1;return!0},hit:e=>e in t.hits&&(t.hits[e]=!0,!0)};return t};const a=(e,t,n,s,o,a,r,i)=>{if(t===a&&n===r)return!0;const l="VERTICAL"===s?t+e.length-1:t,c="VERTICAL"===i?a+e.length-1:a,h="HORIZONTAL"===s?n+e.length-1:n,u="HORIZONTAL"===i?r+e.length-1:r;if(s!==i){const s=Math.min(e.length,o.length),i=(Math.max(e.length,o.length)+1)*s;return(Math.max(t,a,l,c)-Math.min(t,a,l,c)+1)*(Math.max(n,r,h,u)-Math.min(n,r,h,u)+1)<i}if("HORIZONTAL"===s){if(t!==a)return!1;{const e=n<=r&&r<=h,t=r<=n&&n<=u,s=r<=h&&h<=u||t;return!(!(n<=u&&u<=h||e)&&!s)}}if("VERTICAL"===s){if(n!==r)return!1;{const e=t<=a&&a<=l,n=a<=t&&t<=c,s=a<=l&&l<=c||n;return!(!(t<=c&&c<=l||e)&&!s)}}};var r=()=>{const e={ships:[],hits:[],misses:[]};return e.status=new Uint8Array(100),e.placeShip=(t,n,s,o)=>{if("HORIZONTAL"===o&&t.length+s>10)return!1;if("VERTICAL"===o&&t.length+n>10)return!1;for(let r=0;r<e.ships.length;r+=1){const i=e.ships[r];if(a(i.ship,i.row,i.column,i.orientation,t,n,s,o))return!1}return e.ships.push({ship:t,row:n,column:s,orientation:o}),!0},e.receiveAttack=(t,n)=>{const s=10*t+n;for(let o=0;o<e.ships.length;o+=1){const a=e.ships[o],r=a.row,i=a.row+a.ship.length,l=a.column,c=a.column+a.ship.length,h=l<=n&&n<c,u=n-l,m=r<=t&&t<i,p=t-r;switch(a.orientation){case"HORIZONTAL":if(a.row===t&&h)return e.hits.push([t,n]),a.ship.hit(u),void(e.status[s]=1);break;case"VERTICAL":if(a.column===n&&m)return e.hits.push([t,n]),a.ship.hit(p),void(e.status[s]=1)}}e.misses.push([t,n]),e.status[s]=2},e.allSunk=()=>{for(let t=0;t<e.ships.length;t+=1){if(!1===e.ships[t].ship.isSunk())return!1}return!0},e.statusAt=(t,n)=>{const s=10*t+n;return 1===e.status[s]?"HIT":2===e.status[s]?"MISS":null},e};var i=(e,t)=>{const{newGame:n}=e,{playerName:s,playerColor:a}=t;return e=>{n.onclick=()=>{s.value.match(/^\s*$/)||(e.names[0]=s.value,e.colors[0]=a.value,e.gameboards[1]=(()=>{const e=r();let t=0;for(;t<4;){const n=o(4),s=Math.trunc(10*Math.random()),a=Math.trunc(10*Math.random()),r=(s+a)%2==0?"HORIZONTAL":"VERTICAL";e.placeShip(n,s,a,r)&&(t+=1)}return e})(),e.setPhase("PLACEMENT"))}}};const l=(e,t,n,s,o,a)=>{const r=a*o,i=a*s;e.beginPath();let l=t,c=n;for(let t=0;t<=o;t+=1){const t=c+i;e.moveTo(l,c),e.lineTo(l,t),l+=a}l=t,c=n;for(let t=0;t<=s;t+=1){const t=l+r;e.moveTo(l,c),e.lineTo(t,c),c+=a}e.stroke()},c=(e,t)=>n=>{const s=Math.min(e.clientWidth,e.clientHeight),o=s/10,a=(e.clientWidth-s)/2,r=(e.clientHeight-s)/2,i=a+s,l=r+s,c=n.offsetX,h=n.offsetY;if(a<=c&&c<=i&&(r<=h&&h<=l)){const e=c-a,n=h-r,s=Math.trunc(n/o),i=Math.trunc(e/o);t.scopeRow=s,t.scopeColumn=i,null!==t.onscopechange&&t.onscopechange(s,i),t.render()}};class h{reset(){this.showScope=!1,this.showShips=!1,this.gameboard=null,this.scopeRow=0,this.scopeColumn=0}constructor(e,t){const{waterDropletIcon:n,explosionIcon:s,targetScopeIcon:o}=t;this.canvas=e,this.context=e.getContext("2d"),this.waterDropletIcon=n,this.explosionIcon=s,this.targetScopeIcon=o,this.context=e.getContext("2d"),this.showScope=!1,this.showShips=!1,this.showIcons=!1,this.rowCount=10,this.columnCount=10,this.gameboard=null,this.onscopechange=null,e.onmousedown=c(e,this),this.reset()}setScopeCoordinates(e,t){this.scopeRow=e,this.scopeColumn=t}render(){const e=this.canvas.width,t=this.canvas.height,n=this.canvas.clientWidth,s=this.canvas.clientHeight;e===n&&t===s||(this.canvas.width=n,this.canvas.height=s),this.context.clearRect(0,0,this.canvas.width,this.canvas.height);const o=this.canvas.width/this.columnCount,a=this.canvas.height/this.rowCount,r=Math.min(o,a),i=r*this.columnCount,c=r*this.rowCount,h=(this.canvas.width-i)/2,u=(this.canvas.height-c)/2;if(l(this.context,h,u,this.rowCount,this.columnCount,r),null!==this.gameboard){if(!0===this.showShips){this.context.save(),this.context.strokeStyle="#CCC",this.context.lineCap="round",this.context.lineWidth=.75*r;for(let e=0;e<this.gameboard.ships.length;e+=1){const t=this.gameboard.ships[e],n=r/2,s=h+t.column*r+n,o=u+t.row*r+n;if(this.context.beginPath(),this.context.moveTo(s,o),"HORIZONTAL"===t.orientation){const e=s+(t.ship.length-1)*r,n=o;this.context.lineTo(e,n)}else if("VERTICAL"===t.orientation){const e=s,n=o+(t.ship.length-1)*r;this.context.lineTo(e,n)}this.context.stroke()}this.context.restore()}if(!0===this.showIcons){this.context.save();let e=r/this.explosionIcon.width;this.context.scale(e,e);for(let t=0;t<this.gameboard.hits.length;t+=1){const[n,s]=this.gameboard.hits[t],o=h+r*s,a=u+r*n;this.context.drawImage(this.explosionIcon,o/e,a/e)}this.context.restore(),this.context.save(),e=r/this.waterDropletIcon.width,this.context.scale(e,e);for(let t=0;t<this.gameboard.misses.length;t+=1){const[n,s]=this.gameboard.misses[t],o=h+r*s,a=u+r*n;this.context.drawImage(this.waterDropletIcon,o/e,a/e)}this.context.restore()}}if(this.showScope){const e=h+this.scopeColumn*r,t=u+this.scopeRow*r,n=r/this.targetScopeIcon.width;this.context.save(),this.context.scale(n,n),this.context.drawImage(this.targetScopeIcon,e/n,t/n),this.context.restore()}}}var u=(e,t)=>new h(e,t);var m=(e,t,n,s,a,i)=>{const{placeShip:l,resetGameboard:c,startGame:h}=e,{status:m,error:p}=t,d={shipsLeft:4,error:null,gameboard:r(),battleCanvas:u(s,a)},g=()=>{d.battleCanvas.setScopeCoordinates(d.row,d.column),d.battleCanvas.render(),d.shipsLeft>0?m.innerText=`There are ${d.shipsLeft} ship(s) left to be placed!`:m.innerText="No more ships to be placed! Start the game!",null!==d.error?p.innerText=d.error:p.innerText=""},b=()=>{d.shipsLeft=4,d.error=null,d.gameboard=r(),d.row=0,d.column=0,d.battleCanvas.gameboard=d.gameboard,d.battleCanvas.showScope=!0,d.battleCanvas.showShips=!0,d.battleCanvas.showIcons=!1,d.battleCanvas.setScopeCoordinates(d.row,d.column),d.battleCanvas.onscopechange=(e,t)=>{d.row=e,d.column=t,n.shipRow.value=e,n.shipColumn.value=t,g()},n.shipRow.value=d.row,n.shipColumn.value=d.column,n.shipOrientation.selectedIndex=0};return e=>{b(),n.shipRow.onchange=()=>{d.row=Number.parseInt(n.shipRow.value),g()},n.shipColumn.onchange=()=>{d.column=Number.parseInt(n.shipColumn.value),g()},l.onclick=()=>{if(d.shipsLeft>0){const e=o(4),t=Number.parseInt(n.shipRow.value),s=Number.parseInt(n.shipColumn.value),a=n.shipOrientation.selectedOptions[0].value;d.gameboard.placeShip(e,t,s,a)?(d.shipsLeft-=1,d.error=null):d.error="Can't place ship there!"}else d.error="Can't place more ships!";g()},c.onclick=()=>{b(),g()},h.onclick=()=>{0===d.shipsLeft?(e.gameboards[e.selectedGameboard]=d.gameboard,e.setPhase(i)):(d.error="Place all ships before starting the game!",g())},g()}};var p=(e,t)=>{return{name:e,color:t,makeAttack:(e,t,n)=>{e.receiveAttack(t,n)}}};const d=e=>{let t=!1;const n=e.humanGameboard.allSunk(),s=e.computerGameboard.allSunk();return n&&s?(e.statusBar.innerText="IT'S A DRAW!",t=!0):n?(e.statusBar.innerText="WINNER: COMPUTER!",t=!0):s&&(e.statusBar.innerText="WINNER: HUMAN!",t=!0),t},g=e=>{if(d(e))return;const t=e.computerBattle.scopeRow,n=e.computerBattle.scopeColumn;if(null!==e.computerGameboard.statusAt(t,n))return;e.humanPlayer.makeAttack(e.computerGameboard,t,n);const[s,o]=((e,t)=>{let n=Math.trunc(10*Math.random()),s=Math.trunc(10*Math.random());for(;null!==t.statusAt(n,s);)n=Math.trunc(10*Math.random()),s=Math.trunc(10*Math.random());return e.makeAttack(t,n,s),[n,s]})(e.computerPlayer,e.humanGameboard);e.statusBar.innerText=`HUMAN FIRES AT (${t},${n}), COMPUTER FIRES AT (${s},${o})`,e.humanBattle.render(),e.computerBattle.render(),d(e)};var b=(e,t,n,s)=>{const{fireMissile:o}=e,{status:a}=t,{humanCanvas:r,computerCanvas:i}=n;return e=>{const t=e.gameboards[0],n=e.names[0],l=e.colors[0],c=p(n,l),h=e.gameboards[1],m=p("Computer","#803587"),d=u(r,s),b=u(i,s);d.gameboard=t,d.showScope=!1,d.showShips=!0,d.showIcons=!0,b.gameboard=h,b.showScope=!0,b.showShips=!1,b.showIcons=!0,d.render(),b.render();const w={statusBar:a,humanGameboard:t,humanBattle:d,humanPlayer:c,computerGameboard:h,computerBattle:b,computerPlayer:m};o.onclick=()=>{g(w)}}};let w={waterDropletIcon:document.getElementById("water-droplet"),explosionIcon:document.getElementById("explosion"),targetScopeIcon:document.getElementById("target-scope")};const f=s({newGame:document.getElementById("phase-screen-new-game"),placement:document.getElementById("phase-screen-placement"),playComputer:document.getElementById("phase-screen-play-computer")},{newGame:i({newGame:document.getElementById("button-new-game")},{playerName:document.getElementById("string-player-name"),playerColor:document.getElementById("color-player-color")}),placement:m({placeShip:document.getElementById("button-place-ship"),startGame:document.getElementById("button-start-game"),resetGameboard:document.getElementById("button-reset-gameboard")},{status:document.getElementById("bar-placement-status"),error:document.getElementById("bar-placement-error")},{shipRow:document.getElementById("number-ship-row"),shipColumn:document.getElementById("number-ship-column"),shipOrientation:document.getElementById("select-ship-orientation")},document.getElementById("canvas-placement"),w,"PLAY_COMPUTER"),playComputer:b({fireMissile:document.getElementById("button-launch-fire")},{status:document.getElementById("status-play-computer")},{humanCanvas:document.getElementById("canvas-human-player"),computerCanvas:document.getElementById("canvas-computer-player")},w)});document.gameLoop=f,f.setPhase("NEW_GAME")}]);